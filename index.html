<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫</title>
  <style>
    /* –û–±—â–∏–π —Å—Ç–∏–ª—å */
    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background: linear-gradient(180deg, #1e1e2f, #2a2a40);
      color: #fff;
      overflow-x: hidden;
      touch-action: manipulation;
    }

    header {
      background: linear-gradient(135deg, #4facfe, #9d50bb);
      padding: 1rem;
      text-align: center;
      color: white;
      font-size: 1.6rem;
      font-weight: bold;
      border-bottom-left-radius: 16px;
      border-bottom-right-radius: 16px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .days {
      display: flex;
      overflow-x: auto;
      background: #2f2f47;
      padding: 0.5rem;
      box-shadow: inset 0 -2px 4px rgba(0,0,0,0.3);
      -webkit-overflow-scrolling: touch;
    }

    .days::-webkit-scrollbar {
      display: none;
    }

    .day {
      flex: 0 0 auto;
      min-width: 120px;
      text-align: center;
      padding: 0.6rem;
      margin: 0 0.3rem;
      border-radius: 12px;
      background: #3a3a55;
      color: #ccc;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
      white-space: nowrap;
    }
    .day.active {
      background: linear-gradient(135deg, #4facfe, #9d50bb);
      color: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    }

    .schedule {
      padding: 1rem;
      padding-bottom: 8rem;
    }

    .lesson {
      background: #3a3a55;
      margin-bottom: 0.8rem;
      padding: 1rem;
      border-radius: 14px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.3);
      position: relative;
      transition: 0.3s;
    }
    .lesson h4 {
      margin: 0 0 0.4rem 0;
      font-size: 1.05rem;
    }
    .lesson small {
      color: #aaa;
    }

    .lesson.edit-mode {
      background: #50506d;
    }

    .edit-checkbox {
      position: absolute;
      top: 10px;
      right: 12px;
      width: 20px;
      height: 20px;
      accent-color: #4facfe;
      transform: scale(1.3);
      cursor: pointer;
    }

    .hidden {
      display: none !important;
    }

    /* –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å */
    .action-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-around;
      align-items: center;
      background: #1e1e2f;
      padding: 0.6rem 0.4rem;
      box-shadow: 0 -3px 8px rgba(0,0,0,0.4);
      z-index: 999;
    }

    .action-btn {
      flex: 1;
      margin: 0 0.25rem;
      border: none;
      border-radius: 12px;
      padding: 0.7rem;
      font-weight: 600;
      font-size: 0.9rem;
      color: white;
      cursor: pointer;
      transition: 0.2s;
      text-align: center;
      white-space: nowrap;
      -webkit-user-select: none;
      user-select: none;
    }

    .edit-btn { background: linear-gradient(135deg,#4facfe,#00f2fe); }
    .delete-btn { background: #e74c3c; }
    .add-btn { background: #27ae60; }
    .reset-btn { background: #7f8c8d; }

    .action-btn:active { 
      transform: scale(0.95); 
      opacity: 0.9;
    }

    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
    .modal {
      position: fixed;
      top: 0; 
      left: 0;
      width: 100%; 
      height: 100%;
      background: rgba(0,0,0,0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      padding: 1rem;
    }
    
    .modal-content {
      background: #2f2f47;
      padding: 1.2rem;
      border-radius: 16px;
      width: 100%;
      max-width: 500px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      color: white;
    }
    
    .modal-content h3 {
      margin-top: 0;
      margin-bottom: 1rem;
    }
    
    .modal-input {
      width: 100%;
      padding: 0.8rem;
      margin: 0.5rem 0;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      background: #3a3a55;
      color: white;
    }
    
    textarea.modal-input { 
      resize: vertical; 
      min-height: 100px;
    }

    .close-btn {
      background: #e74c3c;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      color: white;
      cursor: pointer;
      margin-top: 1rem;
      float: right;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 480px) {
      header {
        font-size: 1.3rem;
        padding: 0.8rem;
      }
      
      .day {
        min-width: 100px;
        padding: 0.5rem;
        font-size: 0.9rem;
      }
      
      .action-btn {
        padding: 0.6rem;
        font-size: 0.8rem;
      }
    }
  </style>
</head>
<body>
  <header>üìò –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫</header>
  <div class="days" id="days"></div>
  <div class="schedule" id="schedule"></div>

  <!-- –ü–∞–Ω–µ–ª—å –∫–Ω–æ–ø–æ–∫ -->
  <div class="action-bar">
    <button id="editBtn" class="action-btn edit-btn">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
    <button id="deleteBtn" class="action-btn delete-btn hidden">üóë –£–¥–∞–ª–∏—Ç—å</button>
    <button id="addBtn" class="action-btn add-btn hidden">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
    <button id="resetBtn" class="action-btn reset-btn">‚ôªÔ∏è –°–±—Ä–æ—Å</button>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <h3 id="modalTitle"></h3>
      <textarea id="homework" class="modal-input" placeholder="–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ"></textarea>
      <input type="date" id="deadline" class="modal-input">
      <input type="number" id="grade" class="modal-input" placeholder="–û—Ü–µ–Ω–∫–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" min="1" max="5">
      <div style="display: flex; justify-content: space-between; margin-top: 1rem;">
        <button class="close-btn" onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
        <button class="action-btn edit-btn" onclick="saveLesson()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <script>
    // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    const daysOfWeek = ["–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–í—Ç–æ—Ä–Ω–∏–∫", "–°—Ä–µ–¥–∞", "–ß–µ—Ç–≤–µ—Ä–≥", "–ü—è—Ç–Ω–∏—Ü–∞", "–°—É–±–±–æ—Ç–∞"];

    const defaultSchedule = {
      "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫": [
        {name: "–ì–æ—Å. —è–∑—ã–∫ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω", teacher: "–Ø—Ä—É–ª–ª–∏–Ω–∞ –ì.–†."},
        {name: "–†–æ–¥–Ω–æ–π —Ä—É—Å—Å–∫–∏–π", teacher: "–í–∞–ª–∏—É–ª–ª–∏–Ω–∞ –ê.–ò."},
        {name: "–•–∏–º–∏—è", teacher: "–Æ—Å—É–ø–æ–≤–∞ –ê.–ì."}
      ],
      "–í—Ç–æ—Ä–Ω–∏–∫": [
        {name: "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫", teacher: "–í–∞–≥–∞–ø–æ–≤–∞ –ê.–†."},
        {name: "–§–∏–∑–∏–∫–∞", teacher: "–ì–∞–ª–∏–º—É–ª–ª–∏–Ω –ù.–†."}
      ],
      "–°—Ä–µ–¥–∞": [],
      "–ß–µ—Ç–≤–µ—Ä–≥": [],
      "–ü—è—Ç–Ω–∏—Ü–∞": [],
      "–°—É–±–±–æ—Ç–∞": []
    };

    let scheduleData = JSON.parse(localStorage.getItem("schedule")) || JSON.parse(JSON.stringify(defaultSchedule));
    let currentDay = new Date().getDay() - 1;
    currentDay = currentDay < 0 ? 0 : currentDay; // –ï—Å–ª–∏ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
    currentDay = daysOfWeek[currentDay];
    let editMode = false;
    let currentLessonIndex = null;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', function() {
      initApp();
    });

    function initApp() {
      // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
      document.getElementById('editBtn').addEventListener('click', toggleEditMode);
      document.getElementById('deleteBtn').addEventListener('click', deleteSelected);
      document.getElementById('addBtn').addEventListener('click', addLesson);
      document.getElementById('resetBtn').addEventListener('click', resetData);
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
      document.getElementById('modal').addEventListener('click', function(e) {
        if (e.target === this) closeModal();
      });
      
      renderDays();
      renderSchedule();
    }

    function renderDays(){
      const daysContainer = document.getElementById("days");
      daysContainer.innerHTML = "";
      daysOfWeek.forEach(day => {
        const div = document.createElement("div");
        div.className = "day" + (day === currentDay ? " active" : "");
        div.textContent = day;
        div.addEventListener('click', () => {
          currentDay = day; 
          renderDays(); 
          renderSchedule();
        });
        daysContainer.appendChild(div);
      });
    }

    function renderSchedule(){
      const container = document.getElementById("schedule");
      container.innerHTML = "";
      
      if (scheduleData[currentDay].length === 0) {
        container.innerHTML = '<div class="lesson"><h4>–ù–µ—Ç —É—Ä–æ–∫–æ–≤</h4><small>–î–æ–±–∞–≤—å—Ç–µ —É—Ä–æ–∫–∏ —á–µ—Ä–µ–∑ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</small></div>';
        return;
      }
      
      scheduleData[currentDay].forEach((lesson, i) => {
        const div = document.createElement("div");
        div.className = "lesson" + (editMode ? " edit-mode" : "");
        
        let lessonHTML = `<h4>${i+1}. ${lesson.name}</h4>`;
        if (lesson.teacher) lessonHTML += `<small>${lesson.teacher}</small>`;
        if (lesson.homework) lessonHTML += `<br><small>–î–ó: ${lesson.homework}</small>`;
        if (lesson.deadline) lessonHTML += `<br><small>–°—Ä–æ–∫: ${formatDate(lesson.deadline)}</small>`;
        if (lesson.grade) lessonHTML += `<br><small>–û—Ü–µ–Ω–∫–∞: ${lesson.grade}</small>`;
        
        div.innerHTML = lessonHTML;
        
        if(editMode){
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.className = "edit-checkbox";
          checkbox.dataset.index = i;
          div.appendChild(checkbox);
        } else {
          div.addEventListener('click', () => openModal(i));
        }
        container.appendChild(div);
      });
    }

    function formatDate(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString);
      return date.toLocaleDateString('ru-RU');
    }

    function toggleEditMode(){
      editMode = !editMode;
      document.getElementById("deleteBtn").classList.toggle("hidden", !editMode);
      document.getElementById("addBtn").classList.toggle("hidden", !editMode);
      document.getElementById("editBtn").textContent = editMode ? "‚úÖ –ì–æ—Ç–æ–≤–æ" : "‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å";
      renderSchedule();
    }

    function deleteSelected(){
      const checkboxes = document.querySelectorAll(".edit-checkbox:checked");
      if (checkboxes.length === 0) {
        alert("–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–∫–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è");
        return;
      }
      
      if(!confirm(`–£–¥–∞–ª–∏—Ç—å ${checkboxes.length} –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —É—Ä–æ–∫–æ–≤?`)) return;
      
      const indices = Array.from(checkboxes).map(cb => parseInt(cb.dataset.index));
      // –£–¥–∞–ª—è–µ–º –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, —á—Ç–æ–±—ã –∏–Ω–¥–µ–∫—Å—ã –Ω–µ —Å–±–∏–≤–∞–ª–∏—Å—å
      indices.sort((a, b) => b - a).forEach(index => {
        scheduleData[currentDay].splice(index, 1);
      });
      
      localStorage.setItem("schedule", JSON.stringify(scheduleData));
      renderSchedule();
    }

    function addLesson(){
      const name = prompt("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞:");
      if(!name) return;
      const teacher = prompt("–í–≤–µ–¥–∏—Ç–µ —É—á–∏—Ç–µ–ª—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):") || "";
      scheduleData[currentDay].push({name, teacher});
      localStorage.setItem("schedule", JSON.stringify(scheduleData));
      renderSchedule();
    }

    function resetData(){
      if(confirm("–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é? –í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.")){
        scheduleData = JSON.parse(JSON.stringify(defaultSchedule));
        localStorage.setItem("schedule", JSON.stringify(scheduleData));
        renderDays();
        renderSchedule();
      }
    }

    function openModal(index){
      currentLessonIndex = index;
      const lesson = scheduleData[currentDay][index];
      document.getElementById("modalTitle").textContent = lesson.name;
      document.getElementById("homework").value = lesson.homework || "";
      document.getElementById("deadline").value = lesson.deadline || "";
      document.getElementById("grade").value = lesson.grade || "";
      document.getElementById("modal").style.display = "flex";
    }

    function closeModal(){
      document.getElementById("modal").style.display = "none";
    }

    function saveLesson(){
      const lesson = scheduleData[currentDay][currentLessonIndex];
      lesson.homework = document.getElementById("homework").value;
      lesson.deadline = document.getElementById("deadline").value;
      lesson.grade = document.getElementById("grade").value;
      localStorage.setItem("schedule", JSON.stringify(scheduleData));
      closeModal();
      renderSchedule();
    }

    // –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å GitHub Pages
    window.toggleEditMode = toggleEditMode;
    window.deleteSelected = deleteSelected;
    window.addLesson = addLesson;
    window.resetData = resetData;
    window.openModal = openModal;
    window.closeModal = closeModal;
    window.saveLesson = saveLesson;
  </script>
</body>
</html>
